AFFILIATE REVENUE INTEGRATION
==============================

REVENUE STREAMS (Triple Revenue Model)
---------------------------------------

1. SAAS FEES (Base)
   Starter: $60/month
   Growth: $147/month ($99 annual)
   
2. OUTCOME FEES (Performance)
   - 5% of revenue generated by AI agents
   - 10% of cost savings delivered
   - 3% of deals closed by AI sales agents
   
3. AFFILIATE COMMISSIONS (Partners)
   - OpenAI API usage: 10-15% commission
   - Twilio (SMS/Voice): 10% commission
   - Google Workspace: $20-50 per signup
   - Notion: 50% first year
   - Obsidian: 30% one-time
   - Cloudflare: 10% recurring
   - Stripe: $100 per signup + transaction fees
   - Figma: 20% first year
   - Airtable: 20% first year

IMPLEMENTATION
--------------

class AffiliateRevenueTracker:
    """Tracks affiliate revenue from integrated services"""
    
    AFFILIATE_RATES = {
        'openai': {'type': 'usage', 'commission': 0.15},  # 15% of API spend
        'twilio': {'type': 'usage', 'commission': 0.10},   # 10% of SMS/call spend
        'google_workspace': {'type': 'signup', 'commission': 50},  # $50 per signup
        'notion': {'type': 'signup', 'commission': 0.50},  # 50% first year
        'obsidian': {'type': 'signup', 'commission': 0.30, 'period': 'one_time'},
        'cloudflare': {'type': 'usage', 'commission': 0.10},
        'stripe': {'type': 'signup', 'commission': 100, 'transaction_rate': 0.001},
        'figma': {'type': 'signup', 'commission': 0.20},
        'airtable': {'type': 'signup', 'commission': 0.20},
    }
    
    def track_usage(self, service, user_id, amount):
        """Track usage-based affiliate revenue"""
        rate = self.AFFILIATE_RATES.get(service, {})
        if rate.get('type') == 'usage':
            commission = amount * rate['commission']
            self.record_commission(service, user_id, commission, 'usage')
            return commission
    
    def track_signup(self, service, user_id, plan_value):
        """Track signup-based affiliate revenue"""
        rate = self.AFFILIATE_RATES.get(service, {})
        if rate.get('type') == 'signup':
            if isinstance(rate['commission'], float):
                commission = plan_value * rate['commission']
            else:
                commission = rate['commission']
            self.record_commission(service, user_id, commission, 'signup')
            return commission
    
    def get_affiliate_links(self):
        """Get affiliate links for onboarding"""
        return {
            'openai': 'https://platform.openai.com/signup?ref=genii',
            'twilio': 'https://twilio.com/try-twilio?ref=genii',
            'google_workspace': 'https://workspace.google.com/business/signup?ref=genii',
            'notion': 'https://notion.so/signup?ref=genii',
            'obsidian': 'https://obsidian.md/pricing?ref=genii',
            'cloudflare': 'https://dash.cloudflare.com/sign-up?ref=genii',
            'stripe': 'https://stripe.com?ref=genii',
        }

OUTCOME-BASED PRICING (From Crypto Concept)
-------------------------------------------

Instead of just monthly SaaS, charge based on RESULTS:

class OutcomeBasedBilling:
    """Charges based on AI agent performance/outcomes"""
    
    OUTCOME_RATES = {
        'revenue_generated': 0.05,      # 5% of revenue AI brings in
        'cost_saved': 0.10,              # 10% of costs AI reduces
        'deals_closed': 0.03,            # 3% of deal value
        'leads_qualified': 5.00,         # $5 per qualified lead
        'appointments_set': 10.00,       # $10 per appointment
        'content_created': 25.00,        # $25 per piece of content
        'support_tickets': 2.00,         # $2 per ticket resolved
    }
    
    def calculate_outcome_fee(self, metric_type, value):
        """Calculate fee based on outcome"""
        rate = self.OUTCOME_RATES.get(metric_type, 0)
        if isinstance(rate, float) and rate < 1:
            return value * rate  # Percentage
        else:
            return value * rate  # Flat rate per unit
    
    def get_monthly_total(self, user_id):
        """Get total outcome fees for billing"""
        # Query database for user's outcomes this month
        outcomes = self.get_user_outcomes(user_id)
        total = 0
        for outcome in outcomes:
            total += self.calculate_outcome_fee(outcome['type'], outcome['value'])
        return total

ADAPTED CRYPTO CONCEPTS FOR ERP
-------------------------------

1. AGENT AUTONOMY (Light version)
   - Agents work independently on tasks
   - Report outcomes, not just activity
   - Self-optimize based on results

2. MARKETPLACE (Internal)
   - Agents offer services to other agents
   - Internal billing system
   - Skill marketplace

3. STAKING CONCEPT (Loyalty Program)
   - Annual prepay = priority support + discounts
   - Long-term contracts = better rates
   - Commitment rewards

4. ON-CHAIN REPUTATION (Reputation Score)
   - Track agent performance on-chain
   - Public reputation for hiring
   - Immutable work history

5. USDC PAYMENTS (Optional)
   - Accept crypto payments
   - Pay agents in crypto
   - Treasury management

PRICING RECOMMENDATION (Updated)
---------------------------------

FREE TIER (Onboard):
- 3 AI agents
- 500 CRM contacts
- Basic features
- Affiliate links only (we earn from setup)

STARTER: $97/month
- 15 AI agents
- 3,000 contacts
- $50K outcome fee cap
- Standard support

GROWTH: $297/month (or $197 annual)
- 47 AI agents
- 30,000 contacts
- Unlimited outcomes
- Priority support
- Revenue share: 5% of AI-generated revenue

ENTERPRISE: Custom
- Unlimited agents
- Unlimited contacts
- Dedicated infrastructure
- Outcome fees negotiable
- White-label options

REVENUE PROJECTION (Per Customer)
----------------------------------
Month 1-3:
- SaaS: $297
- Outcome fees: $150 (5% of $3K generated)
- Affiliate: $80 (OpenAI + Twilio usage)
- Total: $527/month

Month 4-12:
- SaaS: $297
- Outcome fees: $500 (5% of $10K generated)
- Affiliate: $200 (usage scaled)
- Total: $997/month

Year 1 per customer: ~$8,000
100 customers = $800K ARR
